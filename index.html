<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>K-Pop Release Calendar — demo</title>
  <style>
    :root{
      --bg:#0f1720;
      --card:#0b1220;
      --accent:#e1508a;
      --muted:#9aa6b2;
      --text:#eef6fb;
      --glass: rgba(255,255,255,0.03);
      --dot: #ffdd57;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }

    html,body{height:100%;}
    body{
      margin:0;
      background: linear-gradient(180deg, #071021 0%, #0f1720 100%);
      color:var(--text);
      display:flex;
      align-items:flex-start;
      justify-content:center;
      padding:28px;
      box-sizing:border-box;
    }

    .app {
      width:100%;
      max-width:980px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:12px;
      padding:18px;
      box-shadow: 0 6px 30px rgba(2,6,23,0.7);
      border: 1px solid rgba(255,255,255,0.03);
    }

    header {
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:space-between;
      margin-bottom:12px;
    }

    .title {
      display:flex;
      gap:12px;
      align-items:baseline;
    }
    .title h1{
      font-size:18px;
      margin:0;
      letter-spacing:0.4px;
    }
    .title .sub{
      font-size:12px;
      color:var(--muted);
    }

    .controls {
      display:flex;
      gap:10px;
      align-items:center;
    }

    select, button {
      background:var(--glass);
      color:var(--text);
      border:1px solid rgba(255,255,255,0.04);
      padding:8px 10px;
      border-radius:8px;
      font-size:13px;
      outline:none;
    }

    button:hover { filter:brightness(1.05); cursor:pointer; }

    .calendar-wrap {
      display:grid;
      grid-template-columns: 1fr 340px;
      gap:16px;
    }

    .calendar {
      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.0));
      padding:12px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.02);
    }

    .month-row {
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:8px;
    }
    .month-row .month {
      font-weight:600;
      font-size:16px;
    }

    .weekdays {
      display:grid;
      grid-template-columns: repeat(7,1fr);
      gap:6px;
      color:var(--muted);
      font-size:12px;
      margin-bottom:6px;
      text-transform:uppercase;
      letter-spacing:0.06em;
    }

    .grid {
      display:grid;
      grid-template-columns: repeat(7,1fr);
      gap:6px;
    }

    .day {
      background: rgba(255,255,255,0.01);
      min-height:76px;
      padding:8px;
      border-radius:8px;
      position:relative;
      border:1px solid transparent;
      overflow:hidden;
      transition: transform .06s ease;
    }
    .day:hover{ transform: translateY(-3px); }

    .day.inactive {
      opacity:0.28;
    }
    .day .num {
      font-size:13px;
      font-weight:600;
    }
    .day .songs {
      margin-top:8px;
      font-size:12px;
      line-height:1.1;
      color:var(--muted);
      max-height:42px;
      overflow:auto;
    }

    .day .marker {
      width:8px;
      height:8px;
      border-radius:50%;
      background:var(--dot);
      position:absolute;
      right:8px;
      top:8px;
      box-shadow:0 0 8px rgba(255,221,87,0.18);
    }

    .day.today {
      outline: 2px solid rgba(225,80,138,0.14);
      box-shadow: 0 6px 18px rgba(225,80,138,0.06);
      border-color: rgba(225,80,138,0.12);
    }

    /* right column - list */
    .panel {
      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.0));
      padding:12px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.02);
      height:100%;
      display:flex;
      flex-direction:column;
      gap:8px;
    }

    .panel h2{ margin:0; font-size:15px; }
    .meta { color:var(--muted); font-size:13px; margin-bottom:6px; }

    .song-list {
      overflow:auto;
      padding-right:6px;
      display:flex;
      flex-direction:column;
      gap:8px;
    }

    .song {
      background: rgba(255,255,255,0.02);
      border-radius:8px;
      padding:8px;
      display:flex;
      gap:10px;
      align-items:center;
      border:1px solid rgba(255,255,255,0.02);
    }
    .song .left {
      min-width:44px;
      font-weight:700;
      font-size:12px;
      text-align:center;
    }
    .song .body{
      flex:1;
    }
    .song .title { font-size:14px; font-weight:600; margin-bottom:2px; }
    .song .artist { font-size:13px; color:var(--muted); }

    .hint { font-size:12px; color:var(--muted); margin-top:auto; }

    /* responsive */
    @media (max-width:920px){
      .calendar-wrap { grid-template-columns: 1fr; }
      .panel { order: 2; }
    }
  </style>
</head>
<body>
  <div class="app" role="application" aria-label="K-Pop release calendar demo">
    <header>
      <div class="title">
        <div>
          <h1>K-Pop Release Calendar — demo</h1>
          <div class="sub">Klikni na den, zobrazíme písně vydané toho dne (v libovolném roce)</div>
        </div>
      </div>

      <div class="controls" aria-hidden="false">
        <label for="genSelect" class="sr-only" style="display:none">Generace</label>
        <select id="genSelect" title="Vyber generaci">
          <option value="all">Všechny generace</option>
          <option value="1">1. generace (přibližně 1992–2003)</option>
          <option value="2" selected>2. generace (přibližně 2004–2012)</option>
          <option value="3">3. generace (přibližně 2013–2017)</option>
          <option value="4">4. generace (přibližně 2018–2022)</option>
          <option value="5">5. generace (2023+)</option>
        </select>
        <button id="todayBtn" title="Přejít na aktuální měsíc">Dnes</button>
      </div>
    </header>

    <main class="calendar-wrap">
      <section class="calendar" aria-label="Kalendář">
        <div class="month-row">
          <button id="prev" aria-label="Předchozí měsíc">◀</button>
          <div class="month" id="monthLabel">—</div>
          <button id="next" aria-label="Další měsíc">▶</button>
        </div>

        <div class="weekdays" aria-hidden="true">
          <div>Po</div><div>Út</div><div>St</div><div>Čt</div><div>Pá</div><div>So</div><div>Ne</div>
        </div>

        <div class="grid" id="grid"></div>
      </section>

      <aside class="panel" aria-label="Seznam písní">
        <h2 id="panelTitle">Vyber den</h2>
        <div class="meta" id="panelMeta">Vyber datum v kalendáři vlevo.</div>

        <div class="song-list" id="songList" role="list"></div>

        <div class="hint">
          Tip: přidej do části <code>songs</code> v kódu další položky (atributy: title, artist, release_date, generation).
        </div>
      </aside>
    </main>
  </div>

  <script>
    /* ------------------------
       Demo dataset (rozšiřuj)
       Každý záznam:
       - title: název písně
       - artist: interpret
       - release_date: ISO YYYY-MM-DD (plné datum, my porovnáme měsíc a den)
       - generation: číslo generace (1..5)
       -------------------------*/
    const songs = [
      { title: "G.N.O.", artist: "Wonder Girls", release_date: "2011-11-07", generation: 2 },
      { title: "Nobody", artist: "Wonder Girls", release_date: "2008-10-29", generation: 2 },
      { title: "Gee", artist: "Girls' Generation", release_date: "2009-01-05", generation: 2 },
      { title: "Lies", artist: "Big Bang", release_date: "2007-08-08", generation: 2 },
      { title: "Fire", artist: "2NE1", release_date: "2009-05-06", generation: 2 },
      { title: "Haru Haru", artist: "Big Bang", release_date: "2008-01-01", generation: 2 },
      { title: "Nobody", artist: "g.o.d", release_date: "2000-12-05", generation: 1 },
      { title: "Bang Bang Bang", artist: "BIGBANG", release_date: "2015-06-01", generation: 3 },
      { title: "Ddu-Du Ddu-Du", artist: "BLACKPINK", release_date: "2018-06-15", generation: 4 },
      { title: "Attention", artist: "NewJeans", release_date: "2022-07-22", generation: 4 },
      { title: "Tuxedo", artist: "XG", release_date: "2023-11-10", generation: 5 },
      { title: "Cheer Up", artist: "TWICE", release_date: "2016-04-25", generation: 3 },
      { title: "Bad Girl Good Girl", artist: "Miss A", release_date: "2010-06-30", generation: 2 },
      { title: "Nobody (2011 re-release)", artist: "Wonder Girls", release_date: "2011-11-07", generation: 2 },
      { title: "I Am The Best", artist: "2NE1", release_date: "2011-06-24", generation: 2 }
    ];

    /* Utility: parse date string YYYY-MM-DD safely */
    function parseISODate(d){
      const [y,m,day] = d.split("-").map(Number);
      return {year:y, month:m, day:day};
    }

    // Prepare a lookup mapping from "M-D" to array of songs
    const mdMap = new Map();
    for (const s of songs){
      try {
        const p = parseISODate(s.release_date);
        const key = `${p.month}-${p.day}`;
        if (!mdMap.has(key)) mdMap.set(key, []);
        mdMap.get(key).push(s);
      } catch(e){
        console.warn("Chybný formát data u písně:", s);
      }
    }

    // App state
    let viewDate = new Date(); // current month view
    const monthLabel = document.getElementById("monthLabel");
    const grid = document.getElementById("grid");
    const panelTitle = document.getElementById("panelTitle");
    const panelMeta = document.getElementById("panelMeta");
    const songList = document.getElementById("songList");
    const genSelect = document.getElementById("genSelect");
    const todayBtn = document.getElementById("todayBtn");

    // Localization for month names (česky)
    const monthNames = ["Leden","Únor","Březen","Duben","Květen","Červen","Červenec","Srpen","Září","Říjen","Listopad","Prosinec"];

    function renderCalendar(date){
      grid.innerHTML = "";
      const year = date.getFullYear();
      const month = date.getMonth(); // 0-indexed
      monthLabel.textContent = monthNames[month] + " " + year;

      // first day of month and number of days
      const first = new Date(year, month, 1);
      // JS getDay(): 0 Sun ... 6 Sat. We want Mon..Sun grid, so transform
      const firstWeekday = (first.getDay() + 6) % 7; // Mon=0..Sun=6
      const daysInMonth = new Date(year, month+1, 0).getDate();

      // previous month trailing days (optional) - we'll render inactive days
      const prevMonthDays = firstWeekday; // number of empty slots before day 1

      // compute total slots needed (prev blanks + days)
      const totalSlots = prevMonthDays + daysInMonth;
      // also keep grid consistent with full weeks
      const rows = Math.ceil(totalSlots / 7);
      const slots = rows * 7;

      // determine generation filter
      const genFilter = genSelect.value; // 'all' or '1','2',...
      // todays
      const today = new Date();
      const todayKey = `${today.getMonth()+1}-${today.getDate()}`;

      for (let i = 0; i < slots; i++){
        const cell = document.createElement("div");
        cell.className = "day";
        // decide which day number (or empty)
        const dayNum = i - prevMonthDays + 1;
        if (dayNum <= 0 || dayNum > daysInMonth) {
          // inactive (belongs to previous or next month)
          cell.classList.add("inactive");
          // show blank small content so heights are consistent
          const num = document.createElement("div");
          num.className = "num";
          num.textContent = "";
          cell.appendChild(num);
        } else {
          const num = document.createElement("div");
          num.className = "num";
          num.textContent = dayNum;
          cell.appendChild(num);

          const mdKey = `${month+1}-${dayNum}`;
          const matches = mdMap.get(mdKey) || [];
          const filtered = matches.filter(s => genFilter === "all" ? true : String(s.generation) === genFilter);

          if (filtered.length > 0) {
            const marker = document.createElement("div");
            marker.className = "marker";
            cell.appendChild(marker);

            const list = document.createElement("div");
            list.className = "songs";
            // show up to 3 song titles as preview
            filtered.slice(0,3).forEach(s => {
              const row = document.createElement("div");
              row.textContent = `${s.title} — ${s.artist}`;
              list.appendChild(row);
            });
            if (filtered.length > 3){
              const more = document.createElement("div");
              more.textContent = `…a ${filtered.length - 3} dalších`;
              more.style.color = "var(--muted)";
              more.style.fontSize = "12px";
              list.appendChild(more);
            }
            cell.appendChild(list);
          }

          // today highlight
          if (mdKey === todayKey && dayNum === today.getDate() && (month === today.getMonth() && year === today.getFullYear())){
            cell.classList.add("today");
          }

          // click handler: show details in side panel
          cell.addEventListener("click", () => {
            showSongsFor(month+1, dayNum, filtered, mdKey);
          });
        }
        grid.appendChild(cell);
      }
    }

    function showSongsFor(month, day, filtered, mdKey){
      const niceDate = `${String(day).padStart(2,"0")}.${String(month).padStart(2,"0")}`;
      panelTitle.textContent = `Singly vydané ${niceDate}`;
      const genFilter = genSelect.value;
      panelMeta.textContent = genFilter === "all"
        ? `Zobrazeny všechny generace — ${niceDate}.`
        : `Filtrované pro ${genFilter}. generaci — ${niceDate}.`;

      songList.innerHTML = "";
      // If we were passed the filtered list, use it; otherwise compute
      let list = filtered;
      if (!list) {
        const key = `${month}-${day}`;
        const matches = mdMap.get(key) || [];
        list = matches.filter(s => genFilter === "all" ? true : String(s.generation) === genFilter);
      }

      if (list.length === 0){
        songList.innerHTML = `<div style="color:var(--muted);font-size:13px">Žádné záznamy pro tento den (vybranou generaci).</div>`;
        return;
      }

      // sort by year descending (novější nahoře)
      list.sort((a,b) => {
        const pa = parseISODate(a.release_date);
        const pb = parseISODate(b.release_date);
        return pb.year - pa.year;
      });

      list.forEach(s => {
        const el = document.createElement("div");
        el.className = "song";
        el.setAttribute("role","listitem");
        const left = document.createElement("div");
        left.className = "left";
        // year badge
        left.textContent = parseISODate(s.release_date).year;
        const body = document.createElement("div");
        body.className = "body";
        const title = document.createElement("div");
        title.className = "title";
        title.textContent = s.title;
        const artist = document.createElement("div");
        artist.className = "artist";
        artist.textContent = `${s.artist} • generace ${s.generation}`;
        body.appendChild(title);
        body.appendChild(artist);
        el.appendChild(left);
        el.appendChild(body);
        songList.appendChild(el);
      });
    }

    // nav
    document.getElementById("prev").addEventListener("click", () => {
      viewDate = new Date(viewDate.getFullYear(), viewDate.getMonth() - 1, 1);
      renderCalendar(viewDate);
      // clear panel
      panelTitle.textContent = "Vyber den";
      panelMeta.textContent = "Vyber datum v kalendáři vlevo.";
      songList.innerHTML = "";
    });
    document.getElementById("next").addEventListener("click", () => {
      viewDate = new Date(viewDate.getFullYear(), viewDate.getMonth() + 1, 1);
      renderCalendar(viewDate);
      panelTitle.textContent = "Vyber den";
      panelMeta.textContent = "Vyber datum v kalendáři vlevo.";
      songList.innerHTML = "";
    });
    todayBtn.addEventListener("click", () => {
      viewDate = new Date();
      renderCalendar(viewDate);
    });

    genSelect.addEventListener("change", () => {
      renderCalendar(viewDate);
      // reset panel when generation changes
      panelTitle.textContent = "Vyber den";
      panelMeta.textContent = "Vyber datum v kalendáři vlevo.";
      songList.innerHTML = "";
    });

    // kick off
    renderCalendar(viewDate);

    // small helper: allow double-click on a day to open all years in new tab (example)
    // (Not enabled by default — just a hint for extension)
  </script>
</body>
</html>
