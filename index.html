<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>K-Pop Release Calendar — extended demo</title>
  <style>
    :root{
      --bg:#071021; --card:#071827; --muted:#9aa6b2; --text:#eef6fb; --accent:#e1508a;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    }
    html,body{height:100%; margin:0; background:linear-gradient(180deg,#04101a,#071021); color:var(--text);}
    .wrap{max-width:980px;margin:20px auto;padding:18px;}
    .app{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); padding:16px;border-radius:12px; border:1px solid rgba(255,255,255,0.03); box-shadow:0 8px 40px rgba(2,6,23,0.6);}
    header{display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:12px;}
    h1{margin:0;font-size:18px;}
    .controls{display:flex;gap:8px;align-items:center;}
    select,input[type="file"],button{background:rgba(255,255,255,0.02); color:var(--text); border:1px solid rgba(255,255,255,0.04); padding:8px;border-radius:8px;font-size:13px;}
    button{cursor:pointer;}
    .calendar-wrap{display:grid;grid-template-columns:1fr 360px;gap:14px;}
.calendar {
  position: relative;
  background-size: cover;
  background-position: center;
  transition: background-image 0.5s ease-in-out;
  /*box-shadow: inset 0 0 0 1000px rgba(7, 24, 39, 0.75)*/;
}
    .calendar{padding:12px;border-radius:10px;}
    .month-row{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px;}
    .weekdays{display:grid;grid-template-columns:repeat(7,1fr);gap:6px;color:var(--muted);font-size:12px;margin-bottom:6px;text-transform:uppercase;}
    .grid{display:grid;grid-template-columns:repeat(7,1fr);gap:6px;}
    .day{background:rgba(255,255,255,0.01);min-height:74px;padding:8px;border-radius:8px;position:relative;overflow:hidden;border:1px solid transparent;}
    .day.inactive{opacity:0.26;}
    .day .num{font-size:13px;font-weight:700;}
    .marker{width:8px;height:8px;border-radius:50%;background:#ffdd57;position:absolute;right:8px;top:8px;}
    .day.today{outline:2px solid rgba(225,80,138,0.14);box-shadow:0 6px 18px rgba(225,80,138,0.06);border-color:rgba(225,80,138,0.12);}
    .songs{margin-top:8px;color:var(--muted);font-size:12px;line-height:1.1;max-height:42px;overflow:auto;}
    .panel{padding:12px;border-radius:10px;display:flex;flex-direction:column;gap:8px;height:100%;}
    .song{background:rgba(255,255,255,0.02);border-radius:8px;padding:8px;display:flex;gap:8px;align-items:center;border:1px solid rgba(255,255,255,0.02);}
    .song .left{min-width:46px;font-weight:700;font-size:12px;text-align:center;}
    .song .title{font-weight:700;}
    .meta{color:var(--muted);font-size:13px;}
    .hint{color:var(--muted);font-size:12px;margin-top:auto;}
    @media(max-width:920px){.calendar-wrap{grid-template-columns:1fr;} .panel{order:2;}}
.day.selected {
  outline: 2px solid var(--accent);
  box-shadow: 0 0 12px var(--accent);
  border-color: var(--accent);
}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="app" role="application" aria-label="K-Pop calendar extended demo">
      <header>
        <div>
          <h1>K-Pop Release Calendar — extended demo</h1>
          <div class="meta">Klikni na den pro zobrazení písní vydaných toho dne (nezávisle na roce). Import/Export DB je podporován.</div>
        </div>

        <div class="controls">
          <label for="genSelect" style="display:none">Generace</label>
          <select id="genSelect" title="Vyber generaci">
            <option value="all">Všechny generace</option>
            <option value="1">1. gen (cca 1992–2003)</option>
            <option value="2" selected>2. gen (cca 2004–2012)</option>
            <option value="3">3. gen (cca 2013–2017)</option>
            <option value="4">4. gen (cca 2018–2022)</option>
            <option value="5">5. gen (2023+)</option>
          </select>

          <input id="fileInput" type="file" accept=".json" title="Import JSON (pole objektů)" />
          <button id="exportBtn" title="Export aktuální databáze">Export DB</button>
          <button id="todayBtn" title="Přejít na aktuální měsíc">Dnes</button>
        </div>
      </header>

      <main class="calendar-wrap">
        <section class="calendar" aria-label="Kalendář">
          <div class="month-row">
            <button id="prev">◀</button>
            <div id="monthLabel">—</div>
            <button id="next">▶</button>
          </div>

          <div class="weekdays" aria-hidden="true">
            <div>Po</div><div>Út</div><div>St</div><div>Čt</div><div>Pá</div><div>So</div><div>Ne</div>
          </div>

          <div class="grid" id="grid"></div>
        </section>

        <aside class="panel" aria-label="Seznam písní">
          <h2 id="panelTitle">Vyber den</h2>
          <div class="meta" id="panelMeta">Vyber datum v kalendáři vlevo.</div>
          <div id="songList" role="list"></div>
          <div class="hint">Tip: Importuj JSON s polem písní (atributy: title, artist, release_date YYYY-MM-DD, generation, youtube, spotify). Po importu můžeš exportovat upravenou DB.</div>
        </aside>
      </main>
    </div>
  </div>

  <script>
    /* -------------------------
       Rozšířená demo-databáze (upravit/rozšiřovat)
       Položky: title, artist, release_date (YYYY-MM-DD), generation (1..5), youtube (opt), spotify (opt)
       -------------------------*/
    const songs = [
      /* 1. generace */
      { title:"To My Boyfriend", artist:"Fin.K.L", release_date:"1998-09-01", generation:1, youtube:"https://youtu.be/rNj-jnbB2bQ" },
      { title:"Lies", artist:"g.o.d", release_date:"1999-01-01", generation:1, youtube:"https://youtu.be/7xqJXr3vYHk" },
      { title:"Sea Of Love (사랑을 믿어요)", artist:"S.E.S.", release_date:"1997-11-01", generation:1, youtube:"https://www.youtube.com/" },

      /* 2. generace (vzorek) */
      { title:"G.N.O.", artist:"Wonder Girls", release_date:"2011-11-07", generation:2, youtube:"https://youtu.be/ttJpY9pmSO8" },
{ title:"Irony.", artist:"Wonder Girls", release_date:"2007-02-13", generation:2, youtube:"https://www.youtube.com/watch?v=uxFxoLxmcdg&list=RDuxFxoLxmcdg&start_radio" },
      { title:"Nobody", artist:"Wonder Girls", release_date:"2008-10-29", generation:2, youtube:"https://youtu.be/9f9qK2Jx5uY" },
{ title:"Love Sick", artist:"FTISLAND", release_date:"2007-01-05", generation:2, youtube:"https://www.youtube.com/watch?v=gnLwCb8Cz7I" },
      { title:"Gee", artist:"Girls' Generation", release_date:"2009-01-05", generation:2, youtube:"https://youtu.be/U7mPqycQ0tQ" },
{ title:"Replay", artist:"SHINee", release_date:"2008-05-22", generation:2, youtube:"https://www.youtube.com/watch?v=VTASffPQGhY&list=RDVTASffPQGhY&start_radio" },
      { title:"Oh!", artist:"Girls' Generation", release_date:"2010-02-18", generation:2, youtube:"https://youtu.be/Tk6m6h7dH_Y" },
      { title:"Fire", artist:"2NE1", release_date:"2009-05-06", generation:2, youtube:"https://youtu.be/73Wx4p5eF9w" },
      { title:"I Am The Best", artist:"2NE1", release_date:"2011-06-24", generation:2, youtube:"https://youtu.be/9D0g2U6mGgQ" },
      { title:"Lies", artist:"Big Bang", release_date:"2007-08-08", generation:2, youtube:"https://youtu.be/SLY5WcN5M9g" },
{ title:"10 out of 10", artist:"2PM", release_date:"2008-08-29", generation:2, youtube:"https://www.youtube.com/watch?v=YEmRoYV8vMs" },
      { title:"Haru Haru", artist:"Big Bang", release_date:"2008-01-01", generation:2, youtube:"https://youtu.be/0jkg2Dap6Ts" },
      { title:"Bad Girl Good Girl", artist:"miss A", release_date:"2010-06-30", generation:2, youtube:"https://youtu.be/3K8nG9IybJ4" },
      { title:"Electric Shock", artist:"f(x)", release_date:"2012-06-10", generation:2, youtube:"https://youtu.be/n8I8QGFA1oM" },
{ title:"Not Young", artist:"U-KISS", release_date:"2008-09-03", generation:2, youtube:"https://www.youtube.com/watch?v=eNWr4qixDSY&list=RDeNWr4qixDSY&start_radio" },
{ title:"Lost Child", artist:"IU", release_date:"2008-09-23", generation:2, youtube:"https://www.youtube.com/watch?v=0ZukHxqOA0o" },

      /* 3. generace */
      { title:"Like OOH-AHH", artist:"TWICE", release_date:"2015-10-20", generation:3, youtube:"https://youtu.be/0rtV5esQT6I" },
      { title:"TT", artist:"TWICE", release_date:"2016-10-24", generation:3, youtube:"https://youtu.be/ePpPVE-GGJw" },
      { title:"Bang Bang Bang", artist:"BIGBANG", release_date:"2015-06-01", generation:3, youtube:"https://youtu.be/gdZLi9oWNZg" },
      { title:"Cheer Up", artist:"TWICE", release_date:"2016-04-25", generation:3, youtube:"https://youtu.be/c7rCyll5AeY" },
      { title:"MIC Drop", artist:"BTS", release_date:"2017-11-24", generation:3, youtube:"https://youtu.be/kTlv5_Bs8aw" },
      { title:"Energetic", artist:"Wanna One", release_date:"2017-08-07", generation:3, youtube:"https://youtu.be/8Q2Qd4kqYx8" },

      /* 4. generace */
      { title:"Ddu-Du Ddu-Du", artist:"BLACKPINK", release_date:"2018-06-15", generation:4, youtube:"https://youtu.be/IHNzOHi8sJs" },
      { title:"Attention", artist:"NewJeans", release_date:"2022-07-22", generation:4, youtube:"https://youtu.be/MvZ5b3D3q2o" },
      { title:"IDOL", artist:"BTS", release_date:"2018-08-24", generation:4, youtube:"https://www.youtube.com/watch?v=pBuZEGYXA6E&list=RDpBuZEGYXA6E&start_radio" },
      { title:"Eleven", artist:"IVE", release_date:"2021-12-01", generation:4, youtube:"https://youtu.be/--FmExEAsM8" },
      { title:"Tomboy", artist:"(G)I-DLE", release_date:"2022-03-14", generation:4, youtube:"https://youtu.be/AMd3LwH4Z0A" },

      /* 5. generace (vzorek) */
      { title:"Tuxedo", artist:"XG", release_date:"2023-11-10", generation:5, youtube:"https://youtu.be/placeholder" },

      /* další populární písně pro lepší pokrytí (směs generací) */
      { title:"Break It", artist:"KARA", release_date:"2007-03-29", generation:2, youtube:"https://www.youtube.com/watch?v=9NIYJ8A5R0s&list=RD9NIYJ8A5R0s&start_radio" },
{ title:"Into The New World", artist:"SNSD", release_date:"2007-08-10", generation:2, youtube:"https://youtu.be/GbbLD54pNM0?si=rxzZ9o71fOIzd8cz" },
      { title:"Nobody (g.o.d)", artist:"g.o.d", release_date:"2000-08-03", generation:1, youtube:"https://youtu.be/3Kk13KpG1Wg" },
      { title:"I Need U", artist:"BTS", release_date:"2015-04-29", generation:3, youtube:"https://youtu.be/xEeFrLSkMm8" },
      { title:"Growl", artist:"EXO", release_date:"2013-06-03", generation:3, youtube:"https://youtu.be/ettQSOgWmM0" },
      { title:"Call Me Baby", artist:"EXO", release_date:"2015-03-30", generation:3, youtube:"https://youtu.be/Fu2p9kGx5IY" },
      { title:"Love Scenario", artist:"iKON", release_date:"2018-01-25", generation:4, youtube:"https://youtu.be/vecSVX1QYbs" },
      { title:"Psy - Gangnam Style", artist:"PSY", release_date:"2012-07-15", generation:2, youtube:"https://youtu.be/9bZkp7q19f0" },
      { title:"Mr. Taxi", artist:"Girls' Generation", release_date:"2011-04-27", generation:2, youtube:"https://youtu.be/1g3XHxAZo0M" },
      { title:"Playing With Fire", artist:"BLACKPINK", release_date:"2016-11-01", generation:3, youtube:"https://youtu.be/2S24-y0Ij3Y" },
      { title:"As If It's Your Last", artist:"BLACKPINK", release_date:"2017-06-22", generation:3, youtube:"https://youtu.be/Amq-qlqbjYA" },
      { title:"Spring Day", artist:"BTS", release_date:"2017-02-13", generation:3, youtube:"https://youtu.be/xEeFrLSkMm8" },
      { title:"Bon Bon Chocolat", artist:"EVERGLOW", release_date:"2019-03-18", generation:4, youtube:"https://youtu.be/HvGql8HwOIM" },
      { title:"Blue & Grey", artist:"BTS", release_date:"2020-11-20", generation:4, youtube:"https://youtu.be/t3g0M9Q1Udo" }
    ];
const artistBackgrounds = {
  "Girls' Generation": "https://github.com/KXPOPCZ/kxpopcalendar/blob/main/GirlsGeneration.jpg?raw=true",
  "Wonder Girls": "https://tvujgithub.com/images/wonder_girls.jpg",
  "BLACKPINK": "https://tvujgithub.com/images/blackpink.jpg",
  "TWICE": "https://tvujgithub.com/images/twice.jpg",
  "BTS": "https://tvujgithub.com/images/bts.jpg",
  // další podle potřeby
};


    /* Build map month-day => songs array */
    const mdMap = new Map();
    function buildMapFromArray(arr){
      mdMap.clear();
      for (const s of arr){
        if (!s.release_date) continue;
        const [y,m,d] = s.release_date.split("-").map(Number);
        if (!m || !d) continue;
        const key = `${m}-${d}`;
        if (!mdMap.has(key)) mdMap.set(key, []);
        mdMap.get(key).push(s);
      }
    }
    buildMapFromArray(songs);

    // state
    let viewDate = new Date();
    const monthNames = ["Leden","Únor","Březen","Duben","Květen","Červen","Červenec","Srpen","Září","Říjen","Listopad","Prosinec"];
    const monthLabel = document.getElementById("monthLabel");
    const grid = document.getElementById("grid");
    const panelTitle = document.getElementById("panelTitle");
    const panelMeta = document.getElementById("panelMeta");
    const songList = document.getElementById("songList");
    const genSelect = document.getElementById("genSelect");
    const todayBtn = document.getElementById("todayBtn");

let selectedDayEl = null;
    function renderCalendar(date){
      grid.innerHTML = "";
      const y = date.getFullYear();
      const m = date.getMonth();
      monthLabel.textContent = monthNames[m] + " " + y;

      const first = new Date(y, m, 1);
      const firstWeekday = (first.getDay() + 6) % 7; // Mon=0
      const daysInMonth = new Date(y, m+1, 0).getDate();
      const prevBlanks = firstWeekday;
      const totalSlots = Math.ceil((prevBlanks + daysInMonth)/7) * 7;
      const genFilter = genSelect.value;

      const today = new Date();
      const todayKey = `${today.getMonth()+1}-${today.getDate()}`;

      for (let i=0;i<totalSlots;i++){
        const el = document.createElement("div");
        el.className = "day";
        const dayNum = i - prevBlanks + 1;
        if (dayNum <= 0 || dayNum > daysInMonth){
          el.classList.add("inactive");
          const num = document.createElement("div"); num.className="num"; num.textContent = "";
          el.appendChild(num);
        } else {
          const num = document.createElement("div"); num.className="num"; num.textContent = dayNum;
          el.appendChild(num);
          const key = `${m+1}-${dayNum}`;
          const matches = mdMap.get(key) || [];
          const filtered = matches.filter(s => genFilter === "all" ? true : String(s.generation) === genFilter);

          if (filtered.length > 0){
            const marker = document.createElement("div"); marker.className="marker";
            el.appendChild(marker);
            const list = document.createElement("div"); list.className="songs";
            filtered.slice(0,3).forEach(s => {
              const r = document.createElement("div");
              r.textContent = `${s.title} — ${s.artist}`;
              list.appendChild(r);
            });
            if (filtered.length > 3){
              const more = document.createElement("div"); more.textContent = `…a ${filtered.length-3} dalších`; more.style.color="var(--muted)"; more.style.fontSize="12px"; list.appendChild(more);
            }
            el.appendChild(list);
          }

          if (key === todayKey && dayNum === today.getDate() && (m === today.getMonth() && y === today.getFullYear())){
            el.classList.add("today");
          }

          el.addEventListener("click", () => {
  if (selectedDayEl) selectedDayEl.classList.remove("selected");
  el.classList.add("selected");
  selectedDayEl = el;

  showSongsFor(m + 1, dayNum, filtered, key);
})
const calendarEl = document.querySelector(".calendar");

// vybereme první interpreta z písní, který má obrázek
let bgUrl = "";
for (const song of filtered) {
  if (artistBackgrounds[song.artist]) {
    bgUrl = artistBackgrounds[song.artist];
    break;
  }
}

if (bgUrl) {
  calendarEl.style.backgroundImage = `url('${bgUrl}')`;
} else {
  calendarEl.style.backgroundImage = ""; // reset pokud nic není
};
        }
        grid.appendChild(el);
      }
    }

    function showSongsFor(month, day, filtered, key){
      const niceDate = `${String(day).padStart(2,"0")}.${String(month).padStart(2,"0")}`;
      panelTitle.textContent = `Singly vydané ${niceDate}`;
      const genFilter = genSelect.value;
      panelMeta.textContent = genFilter === "all" ? `Všechny generace — ${niceDate}` : `Filtr: ${genFilter}. generace — ${niceDate}`;
      songList.innerHTML = "";

      let list = filtered;
      if (!list){
        const matches = mdMap.get(`${month}-${day}`) || [];
        list = matches.filter(s => genFilter === "all" ? true : String(s.generation) === genFilter);
      }
      if (list.length === 0){
        songList.innerHTML = `<div style="color:var(--muted);font-size:13px">Žádné záznamy pro tento den (vybraná generace).</div>`;
        return;
      }

      list.sort((a,b) => {
        const ya = parseInt(a.release_date.split("-")[0]||0), yb = parseInt(b.release_date.split("-")[0]||0);
        return yb - ya;
      });

      list.forEach(s => {
        const el = document.createElement("div"); el.className = "song"; el.setAttribute("role","listitem");
        const left = document.createElement("div"); left.className="left"; left.textContent = (s.release_date||"").split("-")[0] || "";
        const body = document.createElement("div"); body.style.flex="1";
        const title = document.createElement("div"); title.className="title"; title.textContent = s.title;
        const artist = document.createElement("div"); artist.style.color="var(--muted)"; artist.textContent = `${s.artist} • gen ${s.generation}`;
        const links = document.createElement("div"); links.style.marginTop="6px";
        if (s.youtube) {
          const a = document.createElement("a"); a.href = s.youtube; a.target="_blank"; a.textContent="YouTube"; a.style.marginRight="10px";
          links.appendChild(a);
        }
        if (s.spotify) {
          const b = document.createElement("a"); b.href = s.spotify; b.target="_blank"; b.textContent="Spotify";
          links.appendChild(b);
        }
        body.appendChild(title); body.appendChild(artist); body.appendChild(links);
        el.appendChild(left); el.appendChild(body);
        songList.appendChild(el);
      });
    }

    // nav
    document.getElementById("prev").addEventListener("click", ()=> { viewDate = new Date(viewDate.getFullYear(), viewDate.getMonth()-1, 1); renderCalendar(viewDate); clearPanel();});
    document.getElementById("next").addEventListener("click", ()=> { viewDate = new Date(viewDate.getFullYear(), viewDate.getMonth()+1, 1); renderCalendar(viewDate); clearPanel();});
    todayBtn.addEventListener("click", ()=> { viewDate = new Date(); renderCalendar(viewDate); });

    genSelect.addEventListener("change", ()=> { renderCalendar(viewDate); clearPanel(); });

    function clearPanel(){ panelTitle.textContent="Vyber den"; panelMeta.textContent="Vyber datum v kalendáři vlevo."; songList.innerHTML=""; }

    // import JSON
    const fileInput = document.getElementById("fileInput");
    fileInput.addEventListener("change", e => {
      const f = e.target.files[0];
      if (!f) return;
      const r = new FileReader();
      r.onload = ev => {
        try {
          const imported = JSON.parse(ev.target.result);
          if (!Array.isArray(imported)) throw new Error("JSON musí být pole objektů.");
          // sanitize & merge: expected keys release_date, title, artist, generation, youtube, spotify
          const sanitized = imported.map(it => {
            return {
              title: it.title || it.name || "unknown",
              artist: it.artist || it.group || "unknown",
              release_date: it.release_date || it.date || "",
              generation: Number(it.generation) || 0,
              youtube: it.youtube || it.yt || it.youtube_url || "",
              spotify: it.spotify || it.spotify_url || ""
            };
          });
          // merge into songs array and rebuild map
          sanitized.forEach(s => songs.push(s));
          buildMapFromArray(songs);
          alert("Import dokončen — databáze rozšířena o " + sanitized.length + " položek.");
          renderCalendar(viewDate); clearPanel();
          fileInput.value = "";
        } catch (err) {
          alert("Chyba při importu: " + err.message);
        }
      };
      r.readAsText(f);
    });

    // export DB
    document.getElementById("exportBtn").addEventListener("click", ()=> {
      const blob = new Blob([JSON.stringify(songs, null, 2)], {type:"application/json"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a"); a.href = url; a.download = "kpop_songs_export.json";
      document.body.appendChild(a); a.click(); a.remove();
      URL.revokeObjectURL(url);
    });

    // init
    renderCalendar(viewDate);

    // optional: click on today's date if any songs exist today (UX)
    (function autoOpenToday(){
      const t = new Date();
      const key = `${t.getMonth()+1}-${t.getDate()}`;
      const matches = mdMap.get(key) || [];
      if (matches.length>0) {
        // find first visible day element for today in current month
        // no auto open to avoid surprising user—leave commented if desired
        // showSongsFor(t.getMonth()+1, t.getDate(), matches, key);
      }
    })();
  </script>
</body>
</html>
